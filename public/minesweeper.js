!function(e){function t(n){if(i[n])return i[n].exports;var s=i[n]={exports:{},id:n,loaded:!1};return e[n].call(s.exports,s,s.exports,t),s.loaded=!0,s.exports}var i={};return t.m=e,t.c=i,t.p="",t(0)}([function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}var s=i(1),l=n(s);new l["default"]({element:document.getElementById("container")})},function(e,t,i){"use strict";function n(e){return e&&e.__esModule?e:{"default":e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function l(e){return f[e]}Object.defineProperty(t,"__esModule",{value:!0});var o=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),r=i(2),a=n(r),u=i(4),c=n(u),h=16,f={9:10,16:40,30:99},d=function(){function e(t){s(this,e),this._el=t.element,this.startGame=this.startGame.bind(this),this.finishGame=this.finishGame.bind(this),this._levelSelector=this._el.querySelector('[data-selector="levelSelector"]'),this._levelSelector.addEventListener("change",this.startGame),this._refreshBtn=this._el.querySelector('[data-selector="refreshBtn"]'),this._refreshBtn.addEventListener("click",this.startGame),this._fieldPlace=this._el.querySelector('[data-component="fieldPlace"]'),this._fieldPlace.addEventListener("endOfGame",this.finishGame)}return o(e,[{key:"startGame",value:function(){this._clear();var t=parseInt(this._levelSelector.options[this._levelSelector.selectedIndex].value);t?(e.showEl(this._refreshBtn),e.showEl(this._fieldPlace),this._field=new a["default"]({element:this._fieldPlace,width:t,height:Math.min(t,h),numberOfMines:l(t)})):(e.hideEl(this._fieldPlace),e.hideEl(this._refreshBtn))}},{key:"finishGame",value:function(e){switch(e.detail.type){case"gameOver":this._gameOverNotification||(this._gameOverNotification=new c["default"]({text:"Game Over!!!",place:this._el,anchor:this._el.querySelector('[data-selector="field"]'),position:"center",additionalStyleClass:"gameOver"})),this._gameOverNotification.show(),this._gameOverNotification.positionAt({anchor:this._fieldPlace,position:"center"});break;case"victory":this._victoryNotification||(this._victoryNotification=new c["default"]({text:"Victory!!!",place:this._el,anchor:this._fieldPlace,position:"center",additionalStyleClass:"victory"})),this._victoryNotification.show(),this._victoryNotification.positionAt({anchor:this._fieldPlace,position:"center"})}}},{key:"_clear",value:function(){this._gameOverNotification&&this._gameOverNotification.hide(),this._victoryNotification&&this._victoryNotification.hide(),this._field&&(this._field.clear(),this._field=null)}},{key:"state",get:function(){return this._state}}],[{key:"showEl",value:function(e){e.classList.remove("js-hidden")}},{key:"hideEl",value:function(e){e.classList.add("js-hidden")}}]),e}();t["default"]=d},function(e,t,i){"use strict";function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t["default"]=e,t}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var l=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),o=i(3),r=n(o);r.installMatches(),r.installClosest(),r.installCustomEvent();var a=function(){function e(t){s(this,e),this._el=t.element,this._width=t.width,this._height=t.height,this._numberOfMines=t.numberOfMines,this._flags=0,this._state=e.PLAYING,this._simultaneousClick={cell:null,leftButtonDown:!1,rightButtonDown:!1},this._renderField(),this._field=this._el.querySelector('[data-selector="field"]'),this._minesLeft=this._el.querySelector('[data-selector="minesIndicator"]'),this._placeMines(),this._placeNumbers(),this._openCell=this._openCell.bind(this),this._field.addEventListener("click",this._openCell),this._setFlag=this._setFlag.bind(this),this._field.addEventListener("contextmenu",this._setFlag),this._onMouseDown=this._onMouseDown.bind(this),this._field.addEventListener("mousedown",this._onMouseDown),this._onMouseUp=this._onMouseUp.bind(this),this._field.addEventListener("mouseup",this._onMouseUp)}return l(e,[{key:"clear",value:function(){this._el.removeChild(this._field),this._field=null}},{key:"cellNeighbours",value:function(e,t){for(var i=[],n=Math.max(e-1,0);n<=Math.min(e+1,this.height-1);n++)for(var s=Math.max(t-1,0);s<=Math.min(t+1,this.width-1);s++)n===e&&s===t||i.push(this._field.rows[n].cells[s]);return i}},{key:"_openCell",value:function(t){if(this.state===e.END_OF_GAME)return null;var i=t.target.closest("td");if(!i)return null;if("covered"!==i.dataset.type)return null;var n=i.parentNode.rowIndex,s=i.cellIndex;e._isAnyMineHere(i)?this._endOfGame("gameOver"):(i.dataset.type="opened",e._showOpenedCell(i),""===i.dataset.info&&this._openEmptyFieldAroundCell(n,s),this._doesPlayerWin()&&this._endOfGame("victory"))}},{key:"_setFlag",value:function(t){if(t.preventDefault(),this.state===e.END_OF_GAME)return null;var i=t.target.closest("td");if(!i)return null;var n=i.dataset.type;if("covered"!==n&&"marked"!==n)return null;switch(n){case"covered":i.dataset.type="marked",this._flags++;break;case"marked":i.dataset.type="covered",this._flags--}e._toggleFlag(i),this._showMinesLeft()}},{key:"_onMouseDown",value:function(t){if(t.preventDefault(),this.state===e.END_OF_GAME)return null;if(1!==t.which&&3!==t.which)return null;var i=t.target.closest("td");if(!i)return null;if(1===t.which&&(this._simultaneousClick.leftButtonDown=!0),3===t.which&&(this._simultaneousClick.rightButtonDown=!0),this._simultaneousClick.cell){var n=this._simultaneousClick.cell===i,s=this._simultaneousClick.leftButtonDown,l=this._simultaneousClick.rightButtonDown;n&&s&&l?this._openNeighbours(i):(this._simultaneousClick.leftButtonDown=!1,this._simultaneousClick.rightButtonDown=!1,this._simultaneousClick.cell=null)}else this._simultaneousClick.cell=i}},{key:"_onMouseUp",value:function(e){e.preventDefault(),1==e.which&&(this._simultaneousClick.leftButtonDown=!1),3==e.which&&(this._simultaneousClick.rightButtonDown=!1),this._deselectCells(),this._simultaneousClick.cell=null}},{key:"_renderField",value:function(){for(var e='<table data-selector="field">',t=0;t<this.height;t++){e+="<tr>\n";for(var i=0;i<this.width;i++)e+='<td class="covered" data-type="covered"></td>\n';e+="</tr>"}e+="</table>",this._el.insertAdjacentHTML("beforeEnd",e)}},{key:"_placeMines",value:function(){for(var t=1;t<=this.numberOfMines;){var i=Math.round(Math.random()*(this.height-1)),n=Math.round(Math.random()*(this.width-1)),s=this._field.rows[i].cells[n];e._isAnyMineHere(s)||(s.dataset.info="M",t++)}this._showMinesLeft()}},{key:"_placeNumbers",value:function(){for(var t=0;t<this.height;t++)for(var i=0;i<this.width;i++){var n=this._field.rows[t].cells[i];if(!e._isAnyMineHere(n)){var s=e._mineCounter(this.cellNeighbours(t,i));n.dataset.info=s||""}}}},{key:"_endOfGame",value:function(t){this._state=e.END_OF_GAME,"gameOver"===t&&this._showMines();var i=new CustomEvent("endOfGame",{detail:{type:t}});this._el.dispatchEvent(i)}},{key:"_openNeighbours",value:function(t){var i=this;if(!t.innerHTML)return null;var n=t.parentNode.rowIndex,s=t.cellIndex,l=this.cellNeighbours(n,s);e._selectCells(l);var o=e._flagCounter(l);parseInt(t.dataset.info)===o&&l.forEach(function(e){var t={target:e};i._openCell(t)})}},{key:"_openEmptyFieldAroundCell",value:function(t,i){var n=this;this.cellNeighbours(t,i).forEach(function(t){var i=e._isAnyMineHere(t),s="opened"===t.dataset.type;if(!i&&!s){var l={target:t};n._openCell(l)}})}},{key:"_doesPlayerWin",value:function(){for(var t=!0,i=0;i<this.height;i++)for(var n=0;n<this.width;n++){var s=this._field.rows[i].cells[n],l=e._isAnyMineHere(s),o="covered"===s.dataset.type||"marked"===s.dataset.type;if(o&&!l){t=!1;break}}return t}},{key:"_deselectCells",value:function(){var e=this._field.querySelectorAll(".selected");[].forEach.call(e,function(e){e.classList.remove("selected")})}},{key:"_showMines",value:function(){for(var t=0;t<this.height;t++)for(var i=0;i<this.width;i++){var n=this._field.rows[t].cells[i];e._isAnyMineHere(n)&&(n.classList.remove("covered"),n.classList.add("exploded"))}}},{key:"_showMinesLeft",value:function(){this._minesLeft.innerHTML=this.numberOfMines-this.flags}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"numberOfMines",get:function(){return this._numberOfMines}},{key:"flags",get:function(){return this._flags}},{key:"state",get:function(){return this._state}}],[{key:"_isAnyMineHere",value:function(e){return"M"===e.dataset.info}},{key:"_mineCounter",value:function(t){return t.reduce(function(t,i){return e._isAnyMineHere(i)&&t++,t},0)}},{key:"_flagCounter",value:function(e){return e.reduce(function(e,t){return"marked"===t.dataset.type&&e++,e},0)}},{key:"_showOpenedCell",value:function(e){e.classList.remove("covered"),e.innerHTML=e.dataset.info}},{key:"_toggleFlag",value:function(e){e.classList.toggle("marked")}},{key:"_selectCells",value:function(e){e.forEach(function(e){"covered"===e.dataset.type&&e.classList.add("selected")})}},{key:"PLAYING",get:function(){return 0}},{key:"END_OF_GAME",get:function(){return 1}}]),e}();t["default"]=a},function(e,t){"use strict";function i(){Element.prototype.matches||(Element.prototype.matches=Element.prototype.matchesSelector||Element.prototype.webkitMatchesSelector||Element.prototype.mozMatchesSelector||Element.prototype.msMatchesSelector)}function n(){Element.prototype.closest||(Element.prototype.closest=function(e){for(var t=this;t;){if(t.matches(e))return t;t=t.parentElement}return null})}function s(){try{new CustomEvent("IE has CustomEvent, but doesn't support constructor")}catch(e){window.CustomEvent=function(e,t){var i;return t=t||{bubbles:!1,cancelable:!1,detail:void 0},i=document.createEvent("CustomEvent"),i.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),i},CustomEvent.prototype=Object.create(window.Event.prototype)}}Object.defineProperty(t,"__esModule",{value:!0}),t.installMatches=i,t.installClosest=n,t.installCustomEvent=s},function(e,t){"use strict";function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}Object.defineProperty(t,"__esModule",{value:!0});var n=function(){function e(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,i,n){return i&&e(t.prototype,i),n&&e(t,n),t}}(),s=10,l=10,o=function(){function e(t){i(this,e),this._el=document.createElement("div"),this._el.className="notification",this._el.innerHTML=t.text,this._el.oncontextmenu=e.preventContextMenu,t.additionalStyleClass&&this._el.classList.add(t.additionalStyleClass);var n=t.place||document.body;n.appendChild(this._el),this.positionAt(t)}return n(e,[{key:"positionAt",value:function(e){if(e.top&&e.left)this._el.style.top=e.top+"px",this._el.style.left=e.left+"px";else{var t=void 0,i=void 0,n=void 0;if(t=e.anchor?e.anchor.getBoundingClientRect():this._el.parentNode.getBoundingClientRect(),e.position)switch(e.position){case"center":i=t.top+t.height/2-this._el.offsetHeight/2,n=t.left+t.width/2-this._el.offsetWidth/2}else i=t.top+s,n=t.right-this._el.offsetWidth-l;this._el.style.top=i+"px",this._el.style.left=n+"px"}}},{key:"show",value:function(){this._el.classList.remove("js-hidden")}},{key:"hide",value:function(){this._el.classList.add("js-hidden")}},{key:"removeNotification",value:function(){this._el.parentNode.removeChild(this._el)}}],[{key:"preventContextMenu",value:function(e){e.preventDefault()}}]),e}();t["default"]=o}]);
//# sourceMappingURL=minesweeper.js.map